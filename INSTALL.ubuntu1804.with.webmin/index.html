



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="MISP Project - Install Guides">
      
      
        <link rel="canonical" href="https://www.misp-project.org/INSTALL.ubuntu1804.with.webmin/">
      
      
        <meta name="author" content="MISP Project">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../img/favicon.ico">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.0.6">
    
    
      
        <title>Ubuntu 18.04 \w webmin - MISP Install Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.451f80e5.css">
      
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#installation-instructions" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://www.misp-project.org/" title="MISP Install Documentation" class="md-header-nav__button md-logo">
          
            <img src="../img/misp.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                MISP Install Documentation
              </span>
              <span class="md-header-nav__topic">
                Ubuntu 18.04 \w webmin
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/MISP/MISP" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      MISP/MISP
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://www.misp-project.org/" title="MISP Install Documentation" class="md-nav__button md-logo">
      
        <img src="../img/misp.png" width="48" height="48">
      
    </a>
    MISP Install Documentation
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/MISP/MISP" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      MISP/MISP
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2" checked>
    
    <label class="md-nav__link" for="nav-2">
      Install Guides
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Install Guides
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../INSTALL.ubuntu1804/" title="Ubuntu 18.04" class="md-nav__link">
      Ubuntu 18.04
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Ubuntu 18.04 \w webmin
      </label>
    
    <a href="./" title="Ubuntu 18.04 \w webmin" class="md-nav__link md-nav__link--active">
      Ubuntu 18.04 \w webmin
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#for-ubuntu-18041-server-with-webmin" title="for Ubuntu 18.04.1-server with Webmin" class="md-nav__link">
    for Ubuntu 18.04.1-server with Webmin
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-webminvirtualmin" title="Why Webmin/Virtualmin?" class="md-nav__link">
    Why Webmin/Virtualmin?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#assumptions" title="Assumptions" class="md-nav__link">
    Assumptions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#misp-configuration-variables" title="MISP configuration variables" class="md-nav__link">
    MISP configuration variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1-minimal-ubuntu-install" title="1/ Minimal Ubuntu install" class="md-nav__link">
    1/ Minimal Ubuntu install
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../INSTALL.debian9/" title="Debian stable" class="md-nav__link">
      Debian stable
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../INSTALL.kali/" title="Kali Linux" class="md-nav__link">
      Kali Linux
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../INSTALL.rhel7/" title="Redhat Enterprise Linux 7" class="md-nav__link">
      Redhat Enterprise Linux 7
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      xInstall Guides
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        xInstall Guides
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../xINSTALL/" title="Warning" class="md-nav__link">
      Warning
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../xINSTALL.centos6/" title="Centos 6" class="md-nav__link">
      Centos 6
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../xINSTALL.centos7/" title="Centos 7" class="md-nav__link">
      Centos 7
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../xINSTALL.debian_testing/" title="Debian testing" class="md-nav__link">
      Debian testing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../xINSTALL.debian9-postgresql/" title="Debian 9 \w postgresql" class="md-nav__link">
      Debian 9 \w postgresql
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../xINSTALL.OpenBSD/" title="OpenBSD 6.4" class="md-nav__link">
      OpenBSD 6.4
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../xINSTALL.rhel7/" title="Redhat Enterprise Linux 7.6 (BETA)" class="md-nav__link">
      Redhat Enterprise Linux 7.6 (BETA)
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Config Guides
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Config Guides
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../CONFIG.elasticsearch-logging/" title="Elastic Search Logging" class="md-nav__link">
      Elastic Search Logging
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../CONFIG.s3-attachments/" title="Amazon S3 attachments" class="md-nav__link">
      Amazon S3 attachments
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../CONFIG.SMIME/" title="S/MIME" class="md-nav__link">
      S/MIME
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../UPDATE/" title="Update MISP" class="md-nav__link">
      Update MISP
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../UPGRADE/" title="Upgrading MISP" class="md-nav__link">
      Upgrading MISP
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      Old guides
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        Old guides
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../archive/old-2_3to2_4-UPGRADE/" title="2.3 to 2.4 upgrade" class="md-nav__link">
      2.3 to 2.4 upgrade
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../archive/INSTALL.ubuntu1604/" title="Ubuntu 16.04" class="md-nav__link">
      Ubuntu 16.04
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      About
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        About
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../Changelog/" title="MISP Release Notes" class="md-nav__link">
      MISP Release Notes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#for-ubuntu-18041-server-with-webmin" title="for Ubuntu 18.04.1-server with Webmin" class="md-nav__link">
    for Ubuntu 18.04.1-server with Webmin
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#why-webminvirtualmin" title="Why Webmin/Virtualmin?" class="md-nav__link">
    Why Webmin/Virtualmin?
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#assumptions" title="Assumptions" class="md-nav__link">
    Assumptions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#misp-configuration-variables" title="MISP configuration variables" class="md-nav__link">
    MISP configuration variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1-minimal-ubuntu-install" title="1/ Minimal Ubuntu install" class="md-nav__link">
    1/ Minimal Ubuntu install
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="installation-instructions">INSTALLATION INSTRUCTIONS<a class="headerlink" href="#installation-instructions" title="Permanent link">&para;</a></h1>
<h2 id="for-ubuntu-18041-server-with-webmin">for Ubuntu 18.04.1-server with Webmin<a class="headerlink" href="#for-ubuntu-18041-server-with-webmin" title="Permanent link">&para;</a></h2>
<div class="admonition notice">
<p class="admonition-title">Notice</p>
<p>Maintained and tested by the community.<br />
Parts of the installation procedures can also be found in the automatic VM generator script <a href="https://github.com/MISP/misp-packer/blob/18.04/scripts/bootstrap.sh">bootstrap.sh</a> of misp-packer.</p>
</div>
<h4 id="why-webminvirtualmin">Why Webmin/Virtualmin?<a class="headerlink" href="#why-webminvirtualmin" title="Permanent link">&para;</a></h4>
<p>Some may not be full time sysadmin and prefer a platform that once it has been setup works and is decently easy to manage.</p>
<h4 id="assumptions">Assumptions<a class="headerlink" href="#assumptions" title="Permanent link">&para;</a></h4>
<p>Assuming you created the subdomanin misp.yourserver.tld to where MISP will be installed and that the user "misp" is in the sudoers group and that you have already configured SSL with Lets Encrypt on the subdomain</p>
<h4 id="misp-configuration-variables">MISP configuration variables<a class="headerlink" href="#misp-configuration-variables" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="c1"># MISP configuration variables</span>
<span class="nv">PATH_TO_MISP</span><span class="o">=</span><span class="s1">&#39;/var/www/MISP&#39;</span>
<span class="nv">CAKE</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$PATH_TO_MISP</span><span class="s2">/app/Console/cake&quot;</span>
<span class="nv">MISP_BASEURL</span><span class="o">=</span><span class="s1">&#39;&quot;&quot;&#39;</span>
<span class="nv">MISP_LIVE</span><span class="o">=</span><span class="s1">&#39;1&#39;</span>

<span class="c1"># Database configuration</span>
<span class="nv">DBHOST</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span>
<span class="nv">DBNAME</span><span class="o">=</span><span class="s1">&#39;misp&#39;</span>
<span class="nv">DBUSER_ADMIN</span><span class="o">=</span><span class="s1">&#39;root&#39;</span>
<span class="nv">DBPASSWORD_ADMIN</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>openssl rand -hex <span class="m">32</span><span class="k">)</span><span class="s2">&quot;</span>
<span class="nv">DBUSER_MISP</span><span class="o">=</span><span class="s1">&#39;misp&#39;</span>
<span class="nv">DBPASSWORD_MISP</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>openssl rand -hex <span class="m">32</span><span class="k">)</span><span class="s2">&quot;</span>

<span class="c1"># Webserver configuration</span>
<span class="nv">FQDN</span><span class="o">=</span><span class="s1">&#39;localhost&#39;</span>

<span class="c1"># OpenSSL configuration</span>
<span class="nv">OPENSSL_CN</span><span class="o">=</span><span class="s1">&#39;Common Name&#39;</span>
<span class="nv">OPENSSL_C</span><span class="o">=</span><span class="s1">&#39;LU&#39;</span>
<span class="nv">OPENSSL_ST</span><span class="o">=</span><span class="s1">&#39;State&#39;</span>
<span class="nv">OPENSSL_L</span><span class="o">=</span><span class="s1">&#39;Location&#39;</span>
<span class="nv">OPENSSL_O</span><span class="o">=</span><span class="s1">&#39;Organization&#39;</span>
<span class="nv">OPENSSL_OU</span><span class="o">=</span><span class="s1">&#39;Organizational Unit&#39;</span>
<span class="nv">OPENSSL_EMAILADDRESS</span><span class="o">=</span><span class="s1">&#39;info@localhost&#39;</span>

<span class="c1"># GPG configuration</span>
<span class="nv">GPG_REAL_NAME</span><span class="o">=</span><span class="s1">&#39;Autogenerated Key&#39;</span>
<span class="nv">GPG_COMMENT</span><span class="o">=</span><span class="s1">&#39;WARNING: MISP AutoGenerated Key consider this Key VOID!&#39;</span>
<span class="nv">GPG_EMAIL_ADDRESS</span><span class="o">=</span><span class="s1">&#39;admin@admin.test&#39;</span>
<span class="nv">GPG_KEY_LENGTH</span><span class="o">=</span><span class="s1">&#39;2048&#39;</span>
<span class="nv">GPG_PASSPHRASE</span><span class="o">=</span><span class="s1">&#39;Password1234&#39;</span>

<span class="c1"># php.ini configuration</span>
<span class="nv">upload_max_filesize</span><span class="o">=</span>50M
<span class="nv">post_max_size</span><span class="o">=</span>50M
<span class="nv">max_execution_time</span><span class="o">=</span><span class="m">300</span>
<span class="nv">memory_limit</span><span class="o">=</span>512M

<span class="nb">echo</span> <span class="s2">&quot;Admin (root) DB Password: </span><span class="nv">$DBPASSWORD_ADMIN</span><span class="s2">&quot;</span>
<span class="nb">echo</span> <span class="s2">&quot;User  (misp) DB Password: </span><span class="nv">$DBPASSWORD_MISP</span><span class="s2">&quot;</span>
</pre></div>

<h3 id="1-minimal-ubuntu-install">1/ Minimal Ubuntu install<a class="headerlink" href="#1-minimal-ubuntu-install" title="Permanent link">&para;</a></h3>
<hr />
<h1 id="make-sure-your-system-is-up2date">Make sure your system is up2date:<a class="headerlink" href="#make-sure-your-system-is-up2date" title="Permanent link">&para;</a></h1>
<p>sudo apt-get update
sudo apt-get upgrade</p>
<h1 id="get-virtualmin">Get Virtualmin<a class="headerlink" href="#get-virtualmin" title="Permanent link">&para;</a></h1>
<p>wget <a href="http://software.virtualmin.com/gpl/scripts/install.sh">http://software.virtualmin.com/gpl/scripts/install.sh</a></p>
<h1 id="install-it">Install it<a class="headerlink" href="#install-it" title="Permanent link">&para;</a></h1>
<p>chmod +x install.sh
./install.sh</p>
<h1 id="grab-a-coffee-while-it-does-its-magic">Grab a coffee while it does its magic<a class="headerlink" href="#grab-a-coffee-while-it-does-its-magic" title="Permanent link">&para;</a></h1>
<h2 id="2-configure-basic-virtualmin-environment">2/ Configure basic Virtualmin environment<a class="headerlink" href="#2-configure-basic-virtualmin-environment" title="Permanent link">&para;</a></h2>
<p>Once the system is installed you can perform the following steps:</p>
<h1 id="install-the-dependencies-some-might-already-be-installed">Install the dependencies: (some might already be installed)<a class="headerlink" href="#install-the-dependencies-some-might-already-be-installed" title="Permanent link">&para;</a></h1>
<p>sudo apt-get install curl gcc git gnupg-agent make python openssl redis-server sudo vim zip</p>
<h1 id="stop-mysql-and-install-mariadb-a-mysql-forkalternative">Stop MySQL and install MariaDB (a MySQL fork/alternative)<a class="headerlink" href="#stop-mysql-and-install-mariadb-a-mysql-forkalternative" title="Permanent link">&para;</a></h1>
<h1 id="mariadb-will-replace-mysql-and-it-will-work-with-the-latests-versions-of-webmin-without-modifications">MariaDB will replace MySQL and it will work with the latests versions of Webmin without modifications<a class="headerlink" href="#mariadb-will-replace-mysql-and-it-will-work-with-the-latests-versions-of-webmin-without-modifications" title="Permanent link">&para;</a></h1>
<h1 id="warning-databases-and-data-will-be-lost-it-is-assumed-you-are-installing-on-a-new-server-with-no-existing-dbs">WARNING: Databases and data will be lost! It is assumed you are installing on a new server with no existing DBs<a class="headerlink" href="#warning-databases-and-data-will-be-lost-it-is-assumed-you-are-installing-on-a-new-server-with-no-existing-dbs" title="Permanent link">&para;</a></h1>
<h1 id="note-at-present-a-simple">NOTE: at present, a simple...<a class="headerlink" href="#note-at-present-a-simple" title="Permanent link">&para;</a></h1>
<h1 id="sudo-service-mysql-stop-sudo-apt-get-install-mariadb-client-mariadb-server">'sudo service mysql stop &amp;&amp; sudo apt-get install mariadb-client mariadb-server'<a class="headerlink" href="#sudo-service-mysql-stop-sudo-apt-get-install-mariadb-client-mariadb-server" title="Permanent link">&para;</a></h1>
<h1 id="doesnt-work-well-with-18041-so-you-should-do-the-following">... doesn't work well with 18.04.1 so you should do the following:<a class="headerlink" href="#doesnt-work-well-with-18041-so-you-should-do-the-following" title="Permanent link">&para;</a></h1>
<p>sudo apt purge mysql-client-5.7 mysql-client-core-5.7 mysql-common mysql-server-5.7 mysql-server-core-5.7 mysql-server</p>
<h1 id="issues-may-crop-up-if-you-leave-mysql-configuration-there-so-remove-also-config-files-in-etcmysql">Issues may crop up if you leave MySQL configuration there so remove also config files in /etc/mysql.<a class="headerlink" href="#issues-may-crop-up-if-you-leave-mysql-configuration-there-so-remove-also-config-files-in-etcmysql" title="Permanent link">&para;</a></h1>
<h1 id="remove-and-cleanup-packages">Remove and cleanup packages<a class="headerlink" href="#remove-and-cleanup-packages" title="Permanent link">&para;</a></h1>
<p>sudo apt autoremove &amp;&amp; sudo apt -f install</p>
<h1 id="add-repositories-for-mariadb-103-and-install-it">Add repositories for Mariadb 10.3 and install it<a class="headerlink" href="#add-repositories-for-mariadb-103-and-install-it" title="Permanent link">&para;</a></h1>
<p>sudo apt-get install software-properties-common
sudo apt-key adv --recv-keys --keyserver hkp://keyserver.ubuntu.com:80 0xF1656F24C74CD1D8
sudo add-apt-repository 'deb [arch=amd64,arm64,ppc64el] <a href="http://mariadb.mirrors.ovh.net/MariaDB/repo/10.3/ubuntu">http://mariadb.mirrors.ovh.net/MariaDB/repo/10.3/ubuntu</a> bionic main'
sudo apt update
sudo apt install mariadb-server</p>
<h1 id="secure-the-mariadb-installation-especially-by-setting-a-strong-root-password-if-it-hasnt-been-asked-during-the-setup-process">Secure the MariaDB installation (especially by setting a strong root password) if it hasn't been asked during the setup process.<a class="headerlink" href="#secure-the-mariadb-installation-especially-by-setting-a-strong-root-password-if-it-hasnt-been-asked-during-the-setup-process" title="Permanent link">&para;</a></h1>
<p>sudo mysql_secure_installation</p>
<h1 id="go-through-the-post-installation-wizard-and-configure-your-mispyourdomaintld-virtual-server">Go through the post-installation Wizard and configure your misp.yourdomain.tld virtual server<a class="headerlink" href="#go-through-the-post-installation-wizard-and-configure-your-mispyourdomaintld-virtual-server" title="Permanent link">&para;</a></h1>
<h1 id="that-should-create-the-misp-user-and-related-directories">That should create the misp user and related directories<a class="headerlink" href="#that-should-create-the-misp-user-and-related-directories" title="Permanent link">&para;</a></h1>
<h1 id="add-the-misp-user-to-the-sudo-group">Add the misp user to the sudo group<a class="headerlink" href="#add-the-misp-user-to-the-sudo-group" title="Permanent link">&para;</a></h1>
<h1 id="install-php-and-dependencies">Install PHP and dependencies<a class="headerlink" href="#install-php-and-dependencies" title="Permanent link">&para;</a></h1>
<p>sudo apt-get install libapache2-mod-php php php-cli php-gnupg php-dev php-json php-mysql php-opcache php-readline php-redis php-xml
sudo pear channel-update pear.php.net
sudo pear install Crypt_GPG</p>
<h1 id="apply-all-changes">Apply all changes<a class="headerlink" href="#apply-all-changes" title="Permanent link">&para;</a></h1>
<p>sudo systemctl restart apache2</p>
<h3 id="3-misp-code">3/ MISP code<a class="headerlink" href="#3-misp-code" title="Permanent link">&para;</a></h3>
<hr />
<h1 id="assuming-you-created-the-subdomanin-mispyourservertld">Assuming you created the subdomanin misp.yourserver.tld<a class="headerlink" href="#assuming-you-created-the-subdomanin-mispyourservertld" title="Permanent link">&para;</a></h1>
<h1 id="download-misp-using-git-in-the-homemisppublic_html-as-misp">Download MISP using git in the /home/misp/public_html/ as misp<a class="headerlink" href="#download-misp-using-git-in-the-homemisppublic_html-as-misp" title="Permanent link">&para;</a></h1>
<p>sudo - misp</p>
<h1 id="or-log-out-root-and-log-back-in-as-misp">or log out root and log back in as misp<a class="headerlink" href="#or-log-out-root-and-log-back-in-as-misp" title="Permanent link">&para;</a></h1>
<p>git clone <a href="https://github.com/MISP/MISP.git">https://github.com/MISP/MISP.git</a> /home/misp/public_html/MISP
cd /home/misp/public_html/MISP
git checkout tags/$(git describe --tags <code>git rev-list --tags --max-count=1</code>)</p>
<h1 id="if-the-last-shortcut-doesnt-work-specify-the-latest-version-manually">if the last shortcut doesn't work, specify the latest version manually<a class="headerlink" href="#if-the-last-shortcut-doesnt-work-specify-the-latest-version-manually" title="Permanent link">&para;</a></h1>
<h1 id="example-git-checkout-tagsv24xy">example: git checkout tags/v2.4.XY<a class="headerlink" href="#example-git-checkout-tagsv24xy" title="Permanent link">&para;</a></h1>
<h1 id="the-message-regarding-a-detached-head-state-is-expected-behaviour">the message regarding a "detached HEAD state" is expected behaviour<a class="headerlink" href="#the-message-regarding-a-detached-head-state-is-expected-behaviour" title="Permanent link">&para;</a></h1>
<h1 id="you-only-have-to-create-a-new-branch-if-you-want-to-change-stuff-and-do-a-pull-request-for-example">(you only have to create a new branch, if you want to change stuff and do a pull request for example)<a class="headerlink" href="#you-only-have-to-create-a-new-branch-if-you-want-to-change-stuff-and-do-a-pull-request-for-example" title="Permanent link">&para;</a></h1>
<p>git submodule update --init --recursive</p>
<h1 id="make-git-ignore-filesystem-permission-differences">Make git ignore filesystem permission differences<a class="headerlink" href="#make-git-ignore-filesystem-permission-differences" title="Permanent link">&para;</a></h1>
<p>git submodule foreach --recursive git config core.filemode false</p>
<h1 id="install-mitres-stix-and-its-dependencies-by-running-the-following-commands">install Mitre's STIX and its dependencies by running the following commands:<a class="headerlink" href="#install-mitres-stix-and-its-dependencies-by-running-the-following-commands" title="Permanent link">&para;</a></h1>
<p>sudo apt-get install python3-dev python3-pip libxml2-dev libxslt1-dev zlib1g-dev python-setuptools python-pip
cd /home/misp/public_html/MISP/app/files/scripts
git clone <a href="https://github.com/CybOXProject/python-cybox.git">https://github.com/CybOXProject/python-cybox.git</a>
git clone <a href="https://github.com/STIXProject/python-stix.git">https://github.com/STIXProject/python-stix.git</a>
cd /home/misp/public_html/MISP/app/files/scripts/python-cybox
sudo python3 setup.py install
cd /home/misp/public_html/MISP/app/files/scripts/python-stix
sudo python3 setup.py install</p>
<h1 id="install-mixbox-to-accommodate-the-new-stix-dependencies">install mixbox to accommodate the new STIX dependencies:<a class="headerlink" href="#install-mixbox-to-accommodate-the-new-stix-dependencies" title="Permanent link">&para;</a></h1>
<p>cd /home/misp/public_html/MISP/app/files/scripts/
git clone <a href="https://github.com/CybOXProject/mixbox.git">https://github.com/CybOXProject/mixbox.git</a>
cd /home/misp/public_html/MISP/app/files/scripts/mixbox
sudo python3 setup.py install</p>
<h1 id="install-pymisp">install PyMISP<a class="headerlink" href="#install-pymisp" title="Permanent link">&para;</a></h1>
<p>pip install jsonschema
cd /home/misp/public_html/MISP/PyMISP
sudo python3 setup.py install</p>
<h2 id="4-cakephp">4/ CakePHP<a class="headerlink" href="#4-cakephp" title="Permanent link">&para;</a></h2>
<h1 id="cakephp-is-included-as-a-submodule-of-misp">CakePHP is included as a submodule of MISP<a class="headerlink" href="#cakephp-is-included-as-a-submodule-of-misp" title="Permanent link">&para;</a></h1>
<h1 id="install-cakeresque-along-with-its-dependencies-if-you-intend-to-use-the-built-in-background-jobs">Install CakeResque along with its dependencies if you intend to use the built in background jobs:<a class="headerlink" href="#install-cakeresque-along-with-its-dependencies-if-you-intend-to-use-the-built-in-background-jobs" title="Permanent link">&para;</a></h1>
<p>cd /home/misp/public_html/MISP/app
php composer.phar require kamisama/cake-resque:4.1.2
php composer.phar config vendor-dir Vendor
php composer.phar install</p>
<h1 id="enable-cakeresque-with-php-redis">Enable CakeResque with php-redis<a class="headerlink" href="#enable-cakeresque-with-php-redis" title="Permanent link">&para;</a></h1>
<p>sudo phpenmod redis</p>
<h1 id="to-use-the-scheduler-worker-for-scheduled-tasks-do-the-following">To use the scheduler worker for scheduled tasks, do the following:<a class="headerlink" href="#to-use-the-scheduler-worker-for-scheduled-tasks-do-the-following" title="Permanent link">&para;</a></h1>
<p>cp -fa /home/misp/public_html/MISP/INSTALL/setup/config.php /home/misp/public_html/MISP/app/Plugin/CakeResque/Config/config.php</p>
<h2 id="5-set-the-permissions">5/ Set the permissions<a class="headerlink" href="#5-set-the-permissions" title="Permanent link">&para;</a></h2>
<h1 id="check-if-the-permissions-are-set-correctly-using-the-following-commands">Check if the permissions are set correctly using the following commands:<a class="headerlink" href="#check-if-the-permissions-are-set-correctly-using-the-following-commands" title="Permanent link">&para;</a></h1>
<p>sudo chmod -R 770 /home/misp/public_html/MISP
sudo chmod -R g+ws /home/misp/public_html/MISP/app/tmp
sudo chmod -R g+ws /home/misp/public_html/MISP/app/files
sudo chmod -R g+ws /home/misp/public_html/MISP/app/files/scripts/tmp</p>
<h2 id="6-create-a-database-and-user">6/ Create a database and user<a class="headerlink" href="#6-create-a-database-and-user" title="Permanent link">&para;</a></h2>
<h1 id="enter-the-mysql-shell">Enter the mysql shell<a class="headerlink" href="#enter-the-mysql-shell" title="Permanent link">&para;</a></h1>
<p>sudo mysql -u root -p</p>
<h1 id="if-all-went-well-when-you-created-the-misp-user-in-virtualmin-you-should-already-have-a-misp-database">If all went well when you created the misp user in Virtualmin you should already have a misp database<a class="headerlink" href="#if-all-went-well-when-you-created-the-misp-user-in-virtualmin-you-should-already-have-a-misp-database" title="Permanent link">&para;</a></h1>
<h1 id="otherwise-create-it-with">otherwise create it with:<a class="headerlink" href="#otherwise-create-it-with" title="Permanent link">&para;</a></h1>
<p>create database misp;</p>
<h1 id="make-sure-password-and-all-privileges-are-set">Make sure password and all privileges are set<a class="headerlink" href="#make-sure-password-and-all-privileges-are-set" title="Permanent link">&para;</a></h1>
<p>grant usage on <em>.</em> to misp@localhost identified by 'XXXXdbpasswordhereXXXXX';
grant all privileges on misp.* to misp@localhost;
flush privileges;
exit</p>
<h1 id="import-the-empty-misp-database-from-mysqlsql">Import the empty MISP database from MYSQL.sql<a class="headerlink" href="#import-the-empty-misp-database-from-mysqlsql" title="Permanent link">&para;</a></h1>
<p>mysql -u misp -p misp &lt; /home/misp/public_html/MISP/INSTALL/MYSQL.sql</p>
<h1 id="enter-the-password-you-set-previously">enter the password you set previously<a class="headerlink" href="#enter-the-password-you-set-previously" title="Permanent link">&para;</a></h1>
<h2 id="7-apache-configuration">7/ Apache configuration<a class="headerlink" href="#7-apache-configuration" title="Permanent link">&para;</a></h2>
<h1 id="most-of-it-should-have-been-done-when-you-created-the-subdomain-but-add-these-changes-as-well">Most of it should have been done when you created the subdomain but add these changes as well<a class="headerlink" href="#most-of-it-should-have-been-done-when-you-created-the-subdomain-but-add-these-changes-as-well" title="Permanent link">&para;</a></h1>
<h1 id="under-80">Under <VirtualHost <IP, FQDN, or *>:80&gt;<a class="headerlink" href="#under-80" title="Permanent link">&para;</a></h1>
<h1 id="servername">ServerName <your.FQDN.here><a class="headerlink" href="#servername" title="Permanent link">&para;</a></h1>
<h1 id="add">add<a class="headerlink" href="#add" title="Permanent link">&para;</a></h1>
<div class="codehilite"><pre><span></span>    Redirect permanent / https://&amp;lt;your.FQDN.here&amp;gt;
    ServerSignature Off
</pre></div>


<h1 id="closing-tag">Closing tag </VirtualHost><a class="headerlink" href="#closing-tag" title="Permanent link">&para;</a></h1>
<h1 id="under-443">Under <VirtualHost <IP, FQDN, or *>:443&gt;<a class="headerlink" href="#under-443" title="Permanent link">&para;</a></h1>
<h1 id="serveradmin-admin">ServerAdmin admin@<your.FQDN.here><a class="headerlink" href="#serveradmin-admin" title="Permanent link">&para;</a></h1>
<h1 id="servername_1">ServerName <your.FQDN.here><a class="headerlink" href="#servername_1" title="Permanent link">&para;</a></h1>
<h1 id="etc">etc...<a class="headerlink" href="#etc" title="Permanent link">&para;</a></h1>
<h1 id="find-the-document-root-and-change-it-as-follows">find the document root and change it as follows<a class="headerlink" href="#find-the-document-root-and-change-it-as-follows" title="Permanent link">&para;</a></h1>
<div class="codehilite"><pre><span></span>    DocumentRoot /home/misp/public_html/MISP/app/webroot
</pre></div>


<h1 id="the-directory-tag-should-be-changed-to">The Directory tag should be changed to:<a class="headerlink" href="#the-directory-tag-should-be-changed-to" title="Permanent link">&para;</a></h1>
<div class="codehilite"><pre><span></span>    &amp;lt;Directory /home/misp/public_html/MISP/app/webroot&amp;gt;
</pre></div>


<h1 id="the-rest-shouldt-require-modifications-restart-apache">The rest should't require modifications. Restart Apache<a class="headerlink" href="#the-rest-shouldt-require-modifications-restart-apache" title="Permanent link">&para;</a></h1>
<p>sudo service apache2 restart</p>
<h2 id="9-misp-configuration">9/ MISP configuration<a class="headerlink" href="#9-misp-configuration" title="Permanent link">&para;</a></h2>
<h1 id="there-are-4-sample-configuration-files-in-homemisppublic_htmlmispappconfig-that-need-to-be-copied">There are 4 sample configuration files in /home/misp/public_html/MISP/app/Config that need to be copied<a class="headerlink" href="#there-are-4-sample-configuration-files-in-homemisppublic_htmlmispappconfig-that-need-to-be-copied" title="Permanent link">&para;</a></h1>
<p>cp -a /home/misp/public_html/MISP/app/Config/bootstrap.default.php /home/misp/public_html/MISP/app/Config/bootstrap.php
cp -a /home/misp/public_html/MISP/app/Config/database.default.php /home/misp/public_html/MISP/app/Config/database.php
cp -a /home/misp/public_html/MISP/app/Config/core.default.php /home/misp/public_html/MISP/app/Config/core.php
cp -a /home/misp/public_html/MISP/app/Config/config.default.php /home/misp/public_html/MISP/app/Config/config.php</p>
<h1 id="configure-the-fields-in-the-newly-created-files">Configure the fields in the newly created files:<a class="headerlink" href="#configure-the-fields-in-the-newly-created-files" title="Permanent link">&para;</a></h1>
<p>vi /home/misp/public_html/MISP/app/Config/database.php</p>
<h1 id="database_config-has-to-be-filled">DATABASE_CONFIG has to be filled<a class="headerlink" href="#database_config-has-to-be-filled" title="Permanent link">&para;</a></h1>
<h1 id="with-the-default-values-provided-in-section-6-this-would-look-like">With the default values provided in section 6, this would look like:<a class="headerlink" href="#with-the-default-values-provided-in-section-6-this-would-look-like" title="Permanent link">&para;</a></h1>
<h1 id="class-database_config">class DATABASE_CONFIG {<a class="headerlink" href="#class-database_config" title="Permanent link">&para;</a></h1>
<h1 id="public-default-array">public $default = array(<a class="headerlink" href="#public-default-array" title="Permanent link">&para;</a></h1>
<h1 id="datasource-databasemysql">'datasource' =&gt; 'Database/Mysql',<a class="headerlink" href="#datasource-databasemysql" title="Permanent link">&para;</a></h1>
<h1 id="persistent-false">'persistent' =&gt; false,<a class="headerlink" href="#persistent-false" title="Permanent link">&para;</a></h1>
<h1 id="host-localhost">'host' =&gt; 'localhost',<a class="headerlink" href="#host-localhost" title="Permanent link">&para;</a></h1>
<h1 id="login-misp-grant-usage-on-to-misplocalhost">'login' =&gt; 'misp', // grant usage on <em>.</em> to misp@localhost<a class="headerlink" href="#login-misp-grant-usage-on-to-misplocalhost" title="Permanent link">&para;</a></h1>
<h1 id="port-3306">'port' =&gt; 3306,<a class="headerlink" href="#port-3306" title="Permanent link">&para;</a></h1>
<h1 id="password-xxxxdbpasswordherexxxxx-identified-by-xxxxdbpasswordherexxxxx">'password' =&gt; 'XXXXdbpasswordhereXXXXX', // identified by 'XXXXdbpasswordhereXXXXX';<a class="headerlink" href="#password-xxxxdbpasswordherexxxxx-identified-by-xxxxdbpasswordherexxxxx" title="Permanent link">&para;</a></h1>
<h1 id="database-misp-create-database-misp">'database' =&gt; 'misp', // create database misp;<a class="headerlink" href="#database-misp-create-database-misp" title="Permanent link">&para;</a></h1>
<h1 id="prefix">'prefix' =&gt; '',<a class="headerlink" href="#prefix" title="Permanent link">&para;</a></h1>
<h1 id="encoding-utf8">'encoding' =&gt; 'utf8',<a class="headerlink" href="#encoding-utf8" title="Permanent link">&para;</a></h1>
<h1 id="_1">);<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<h1 id="_2">}<a class="headerlink" href="#_2" title="Permanent link">&para;</a></h1>
<h1 id="important-change-the-salt-key-in-homemisppublic_htmlmispappconfigconfigphp">Important! Change the salt key in /home/misp/public_html/MISP/app/Config/config.php<a class="headerlink" href="#important-change-the-salt-key-in-homemisppublic_htmlmispappconfigconfigphp" title="Permanent link">&para;</a></h1>
<h1 id="see-line-7-may-change">see line 7 (may change)<a class="headerlink" href="#see-line-7-may-change" title="Permanent link">&para;</a></h1>
<h1 id="salt-yoursaltkeyhere">'salt' =&gt; 'yoursaltkeyhere'<a class="headerlink" href="#salt-yoursaltkeyhere" title="Permanent link">&para;</a></h1>
<h1 id="the-salt-key-must-be-a-string-at-least-32-bytes-long">The salt key must be a string at least 32 bytes long.<a class="headerlink" href="#the-salt-key-must-be-a-string-at-least-32-bytes-long" title="Permanent link">&para;</a></h1>
<h1 id="the-admin-user-account-will-be-generated-on-the-first-login-make-sure-that-the-salt-is-changed-before-you-create-that-user">The admin user account will be generated on the first login, make sure that the salt is changed before you create that user<a class="headerlink" href="#the-admin-user-account-will-be-generated-on-the-first-login-make-sure-that-the-salt-is-changed-before-you-create-that-user" title="Permanent link">&para;</a></h1>
<h1 id="if-you-forget-to-do-this-step-and-you-are-still-dealing-with-a-fresh-installation-just-alter-the-salt">If you forget to do this step, and you are still dealing with a fresh installation, just alter the salt,<a class="headerlink" href="#if-you-forget-to-do-this-step-and-you-are-still-dealing-with-a-fresh-installation-just-alter-the-salt" title="Permanent link">&para;</a></h1>
<h1 id="delete-the-user-from-mysql-and-log-in-again-using-the-default-admin-credentials-amp97amp100amp109amp105amp110amp64amp97amp100amp109amp105amp110amp46amp116amp101amp115amp116-admin">delete the user from mysql and log in again using the default admin credentials (<a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#97;&#100;&#109;&#105;&#110;&#64;&#97;&#100;&#109;&#105;&#110;&#46;&#116;&#101;&#115;&#116;">&#97;&#100;&#109;&#105;&#110;&#64;&#97;&#100;&#109;&#105;&#110;&#46;&#116;&#101;&#115;&#116;</a> / admin)<a class="headerlink" href="#delete-the-user-from-mysql-and-log-in-again-using-the-default-admin-credentials-amp97amp100amp109amp105amp110amp64amp97amp100amp109amp105amp110amp46amp116amp101amp115amp116-admin" title="Permanent link">&para;</a></h1>
<h1 id="change-base-url-in-configphp">Change base url in config.php<a class="headerlink" href="#change-base-url-in-configphp" title="Permanent link">&para;</a></h1>
<p>vi /home/misp/public_html/MISP/app/Config/config.php</p>
<h1 id="example-baseurl-https">example: 'baseurl' =&gt; 'https://<your.FQDN.here>',<a class="headerlink" href="#example-baseurl-https" title="Permanent link">&para;</a></h1>
<h1 id="alternatively-you-can-leave-this-field-empty-if-you-would-like-to-use-relative-pathing-in-misp">alternatively, you can leave this field empty if you would like to use relative pathing in MISP<a class="headerlink" href="#alternatively-you-can-leave-this-field-empty-if-you-would-like-to-use-relative-pathing-in-misp" title="Permanent link">&para;</a></h1>
<h1 id="baseurl">'baseurl' =&gt; '',<a class="headerlink" href="#baseurl" title="Permanent link">&para;</a></h1>
<h1 id="email-amp97amp110amp101amp109amp97amp105amp108amp64amp121amp111amp117amp114amp100amp111amp109amp97amp105amp110amp46amp116amp108amp100-set-an-email-address-that-will-be-used-for-gpg">'email' =&gt; '<a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#97;&#110;&#101;&#109;&#97;&#105;&#108;&#64;&#121;&#111;&#117;&#114;&#100;&#111;&#109;&#97;&#105;&#110;&#46;&#116;&#108;&#100;">&#97;&#110;&#101;&#109;&#97;&#105;&#108;&#64;&#121;&#111;&#117;&#114;&#100;&#111;&#109;&#97;&#105;&#110;&#46;&#116;&#108;&#100;</a>, set an email address that will be used for gpg<a class="headerlink" href="#email-amp97amp110amp101amp109amp97amp105amp108amp64amp121amp111amp117amp114amp100amp111amp109amp97amp105amp110amp46amp116amp108amp100-set-an-email-address-that-will-be-used-for-gpg" title="Permanent link">&para;</a></h1>
<h1 id="and-make-sure-the-file-permissions-are-still-ok">and make sure the file permissions are still OK<a class="headerlink" href="#and-make-sure-the-file-permissions-are-still-ok" title="Permanent link">&para;</a></h1>
<p>chmod -R 750 /home/misp/public_html/MISP/app/Config</p>
<h1 id="generate-a-gpg-encryption-key">Generate a GPG encryption key.<a class="headerlink" href="#generate-a-gpg-encryption-key" title="Permanent link">&para;</a></h1>
<p>mkdir /home/misp/public_html/MISP/.gnupg
chmod 700 /home/misp/public_html/MISP/.gnupg</p>
<h1 id="if-you-get-no-satisfaction-with-your-entropy-install-this">If you get no satisfaction with your entropy install this:<a class="headerlink" href="#if-you-get-no-satisfaction-with-your-entropy-install-this" title="Permanent link">&para;</a></h1>
<p>sudo apt-get install haveged pv</p>
<h1 id="generate-entropy-for-the-next-step-open-a-new-shell-and-run-the-following-command">Generate entropy for the next step, open a new shell and run the following command:<a class="headerlink" href="#generate-entropy-for-the-next-step-open-a-new-shell-and-run-the-following-command" title="Permanent link">&para;</a></h1>
<p>haveged -n 0 | pv &gt; /dev/null</p>
<h1 id="it-should-start-saying-something-like-writing-unlimited-bytes-to-stdout">It should start saying something like "Writing unlimited bytes to stdout"<a class="headerlink" href="#it-should-start-saying-something-like-writing-unlimited-bytes-to-stdout" title="Permanent link">&para;</a></h1>
<h1 id="let-it-run-and-go-back-to-the-previous-shell">let it run and go back to the previous shell<a class="headerlink" href="#let-it-run-and-go-back-to-the-previous-shell" title="Permanent link">&para;</a></h1>
<p>gpg --homedir /home/misp/public_html/MISP/.gnupg --gen-key</p>
<h1 id="the-email-address-should-match-the-one-set-in-the-configphp-set-in-the-configuration-menu-in-the-administration-menu-configuration-file">The email address should match the one set in the config.php / set in the configuration menu in the administration menu configuration file<a class="headerlink" href="#the-email-address-should-match-the-one-set-in-the-configphp-set-in-the-configuration-menu-in-the-administration-menu-configuration-file" title="Permanent link">&para;</a></h1>
<h1 id="you-can-now-ctrelc-the-running-haveged-in-the-other-shell">You can now Ctrel+C the running haveged in the other shell<a class="headerlink" href="#you-can-now-ctrelc-the-running-haveged-in-the-other-shell" title="Permanent link">&para;</a></h1>
<h1 id="and-return-to-the-install-shell">and return to the "install" shell<a class="headerlink" href="#and-return-to-the-install-shell" title="Permanent link">&para;</a></h1>
<h1 id="export-the-public-key-to-the-webroot">Export the public key to the webroot<a class="headerlink" href="#export-the-public-key-to-the-webroot" title="Permanent link">&para;</a></h1>
<p>gpg --homedir /home/misp/public_html/MISP/.gnupg --export --armor YOUR-KEYS-EMAIL-HERE &gt; /home/misp/public_html/MISP/app/webroot/gpg.asc</p>
<h1 id="to-make-the-background-workers-start-on-boot">To make the background workers start on boot<a class="headerlink" href="#to-make-the-background-workers-start-on-boot" title="Permanent link">&para;</a></h1>
<p>chmod +x /home/misp/public_html/MISP/app/Console/worker/start.sh</p>
<h1 id="activate-rclocal-in-systemd">Activate rc.local in systemd<a class="headerlink" href="#activate-rclocal-in-systemd" title="Permanent link">&para;</a></h1>
<h1 id="systemd-developers-in-their-wisdom-decided-to-complicate-things-a-bit-so-youll-have-to">Systemd developers, in their wisdom, decided to complicate things a bit so you'll have to<a class="headerlink" href="#systemd-developers-in-their-wisdom-decided-to-complicate-things-a-bit-so-youll-have-to" title="Permanent link">&para;</a></h1>
<h1 id="create-the-rc-localservice">create the rc-local.service<a class="headerlink" href="#create-the-rc-localservice" title="Permanent link">&para;</a></h1>
<p>sudo vi /etc/systemd/system/rc-local.service</p>
<h1 id="and-paste-the-following-in-it">and paste the following in it<a class="headerlink" href="#and-paste-the-following-in-it" title="Permanent link">&para;</a></h1>
<p>[Unit]
 Description=/etc/rc.local Compatibility
 ConditionPathExists=/etc/rc.local</p>
<p>[Service]
 Type=forking
 ExecStart=/etc/rc.local start
 TimeoutSec=0
 StandardOutput=tty
 RemainAfterExit=yes
 SysVStartPriority=99</p>
<p>[Install]
 WantedBy=multi-user.target</p>
<h1 id="hit-the-esc-button-then-type-wq-to-write-the-file-and-exit-vi">Hit the "esc" button then type :wq! to write the file and exit vi<a class="headerlink" href="#hit-the-esc-button-then-type-wq-to-write-the-file-and-exit-vi" title="Permanent link">&para;</a></h1>
<h1 id="createedit-etcrclocal">Create/edit /etc/rc.local<a class="headerlink" href="#createedit-etcrclocal" title="Permanent link">&para;</a></h1>
<p>sudo vi /etc/rc.local</p>
<h1 id="if-the-file-is-empty-add-the-following-including-the">If the file is empty add the following including the<a class="headerlink" href="#if-the-file-is-empty-add-the-following-including-the" title="Permanent link">&para;</a></h1>
<h1 id="binbash">!/bin/bash<a class="headerlink" href="#binbash" title="Permanent link">&para;</a></h1>
<h1 id="then-add-this">Then add this<a class="headerlink" href="#then-add-this" title="Permanent link">&para;</a></h1>
<p>sudo -u misp bash /home/misp/public_html/MISP/app/Console/worker/start.sh</p>
<h1 id="if-the-file-was-empty-add-this-as-the-last-line">If the file was empty add this as the last line<a class="headerlink" href="#if-the-file-was-empty-add-this-as-the-last-line" title="Permanent link">&para;</a></h1>
<p>exit 0</p>
<h1 id="save-quit-vi-and-set-permissions">save, quit vi and set permissions<a class="headerlink" href="#save-quit-vi-and-set-permissions" title="Permanent link">&para;</a></h1>
<p>sudo chmod +x /etc/rc.local</p>
<h1 id="enable-it-in-systemd">Enable it in systemd<a class="headerlink" href="#enable-it-in-systemd" title="Permanent link">&para;</a></h1>
<p>sudo systemctl enable rc-local</p>
<h1 id="start-the-rc-local-compatibility-layer-and-check-if-aok">Start the rc-local compatibility layer and check if AOK<a class="headerlink" href="#start-the-rc-local-compatibility-layer-and-check-if-aok" title="Permanent link">&para;</a></h1>
<p>sudo systemctl start rc-local.service
sudo systemctl status rc-local.service</p>
<div class="admonition notice">
<p class="admonition-title">Notice</p>
<p>Once done, have a look at the diagnostics
If any of the directories that MISP uses to store files is not writeable to the apache user, change the permissions
you can do this by running the following commands:
<div class="codehilite"><pre><span></span>sudo chmod -R 770 /home/misp/public_html/MISP/&lt;directory path with an indicated issue&gt;
sudo chown -R misp:www-data /home/misp/public_html/MISP/&lt;directory path with an indicated issue&gt;
</pre></div></p>
</div>
<div class="admonition notice">
<p class="admonition-title">Notice</p>
<p>If anything goes wrong, make sure that you check MISP's logs for errors:
```</p>
<h1 id="homemisppublic_htmlmispapptmplogserrorlog">/home/misp/public_html/MISP/app/tmp/logs/error.log<a class="headerlink" href="#homemisppublic_htmlmispapptmplogserrorlog" title="Permanent link">&para;</a></h1>
<h1 id="homemisppublic_htmlmispapptmplogsresque-worker-errorlog">/home/misp/public_html/MISP/app/tmp/logs/resque-worker-error.log<a class="headerlink" href="#homemisppublic_htmlmispapptmplogsresque-worker-errorlog" title="Permanent link">&para;</a></h1>
<h1 id="homemisppublic_htmlmispapptmplogsresque-scheduler-errorlog">/home/misp/public_html/MISP/app/tmp/logs/resque-scheduler-error.log<a class="headerlink" href="#homemisppublic_htmlmispapptmplogsresque-scheduler-errorlog" title="Permanent link">&para;</a></h1>
<h1 id="homemisppublic_htmlmispapptmplogsresque-2015-01-01log-where-the-actual-date-is-the-current-date">/home/misp/public_html/MISP/app/tmp/logs/resque-2015-01-01.log // where the actual date is the current date<a class="headerlink" href="#homemisppublic_htmlmispapptmplogsresque-2015-01-01log-where-the-actual-date-is-the-current-date" title="Permanent link">&para;</a></h1>
</div>
<p>```</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you have installed the recommended Python 3 virtualenv to the recommended place of <strong>${PATH_TO_MISP}/venv</strong> set the following MISP configurable
<div class="codehilite"><pre><span></span>sudo <span class="nv">$CAKE</span> Admin setSetting <span class="s2">&quot;MISP.python_bin&quot;</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">PATH_TO_MISP</span><span class="si">}</span><span class="s2">/venv/bin/python&quot;</span>
</pre></div>
or on CentOS
<div class="codehilite"><pre><span></span>sudo <span class="nv">$RUN_PHP</span> <span class="s2">&quot;</span><span class="nv">$CAKE</span><span class="s2"> Admin setSetting &quot;</span>MISP.python_bin<span class="s2">&quot; &quot;</span><span class="si">${</span><span class="nv">PATH_TO_MISP</span><span class="si">}</span>/venv/bin/python<span class="s2">&quot;&quot;</span>
</pre></div></p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Make sure that the STIX libraries and GnuPG work as intended, if not, refer to the relevant sections in the install guide you are currently reading.</p>
</div>
<div class="admonition notice">
<p class="admonition-title">Notice</p>
<p>Now log in using the webinterface: http://misp/users/login<br />
The default user/pass = <a href="&#109;&#97;&#105;&#108;&#116;&#111;&#58;&#97;&#100;&#109;&#105;&#110;&#64;&#97;&#100;&#109;&#105;&#110;&#46;&#116;&#101;&#115;&#116;">&#97;&#100;&#109;&#105;&#110;&#64;&#97;&#100;&#109;&#105;&#110;&#46;&#116;&#101;&#115;&#116;</a>/admin<br />
Using the server settings tool in the admin interface (Administration -&gt; Server Settings), set MISP up to your preference.<br />
It is especially vital that no critical issues remain!<br />
Don't forget to change the email, password and authentication key after installation.<br />
Once done, have a look at the diagnostics.</p>
</div>
<div class="admonition notice">
<p class="admonition-title">Notice</p>
<p>If any of the directories that MISP uses to store files is not writeable to the apache user, change the permissions<br />
you can do this by running the following commands:
<div class="codehilite"><pre><span></span>chmod -R <span class="m">750</span> <span class="si">${</span><span class="nv">PATH_TO_MISP</span><span class="si">}</span>/&lt;directory path with an indicated issue&gt;
<span class="c1"># /!\ Depending on your OS replace www-data with apache or www or whatever user is the web server user.</span>
chown -R www-data:www-data <span class="si">${</span><span class="nv">PATH_TO_MISP</span><span class="si">}</span>/&lt;directory path with an indicated issue&gt;
</pre></div></p>
</div>
<div class="admonition notice">
<p class="admonition-title">Notice</p>
<p>If anything goes wrong, make sure that you check MISP's logs for errors:
<div class="codehilite"><pre><span></span># ${PATH_TO_MISP}/app/tmp/logs/error.log
# ${PATH_TO_MISP}/app/tmp/logs/resque-worker-error.log
# ${PATH_TO_MISP}/app/tmp/logs/resque-scheduler-error.log
# ${PATH_TO_MISP}/app/tmp/logs/resque-2018-10-25.log //where the actual date is the current date
</pre></div></p>
</div>
<h3 id="recommended-actions">Recommended actions<a class="headerlink" href="#recommended-actions" title="Permanent link">&para;</a></h3>
<hr />
<ul>
<li>
<p>By default CakePHP exposes his name and version in email headers. Apply a patch to remove this behavior.</p>
</li>
<li>
<p>You should really harden your OS</p>
</li>
<li>You should really harden the configuration of Apache</li>
<li>You should really harden the configuration of MySQL</li>
<li>Keep your software up2date (MISP, CakePHP and everything else)</li>
<li>Log and audit</li>
</ul>
<h3 id="optional-features">Optional features<a class="headerlink" href="#optional-features" title="Permanent link">&para;</a></h3>
<hr />
<h4 id="misp-has-a-new-pubsub-feature-using-zeromq-to-enable-it-simply-run-the-following-command">MISP has a new pub/sub feature, using ZeroMQ. To enable it, simply run the following command<a class="headerlink" href="#misp-has-a-new-pubsub-feature-using-zeromq-to-enable-it-simply-run-the-following-command" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span>sudo pip3 install pyzmq
<span class="c1"># ZeroMQ depends on the Python client for Redis</span>
sudo pip3 install redis
</pre></div>

<h4 id="experimental-ssdeep-correlations">Experimental ssdeep correlations<a class="headerlink" href="#experimental-ssdeep-correlations" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="c1"># installing ssdeep</span>
wget http://downloads.sourceforge.net/project/ssdeep/ssdeep-2.13/ssdeep-2.13.tar.gz
tar zxvf ssdeep-2.13.tar.gz
<span class="nb">cd</span> ssdeep-2.13
./configure
make
sudo make install
ssdeep -h <span class="c1"># test</span>

<span class="c1">#installing ssdeep_php</span>
sudo pecl install ssdeep

<span class="c1"># You should add &quot;extension=ssdeep.so&quot; to mods-available - Check /etc/php for your current version</span>
<span class="nb">echo</span> <span class="s2">&quot;extension=ssdeep.so&quot;</span> <span class="p">|</span> sudo tee /etc/php/7.2/mods-available/ssdeep.ini
sudo phpenmod ssdeep
sudo service apache2 restart
</pre></div>

<div class="admonition notice">
<p class="admonition-title">Notice</p>
<p>If you want to add the misp modules functionality, follow the setup procedure described in misp-modules:<br />
<a href="https://github.com/MISP/misp-modules#how-to-install-and-start-misp-modules">https://github.com/MISP/misp-modules#how-to-install-and-start-misp-modules</a><br />
Then the enrichment, export and import modules can be enabled in MISP via the settings.</p>
</div>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../INSTALL.ubuntu1804/" title="Ubuntu 18.04" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Ubuntu 18.04
              </span>
            </div>
          </a>
        
        
          <a href="../INSTALL.debian9/" title="Debian stable" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Debian stable
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2019 MISP Project
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    <link rel="stylesheet" href="../assets/fonts/font-awesome.css">
    
      <a href="https://www.misp-project.org/" class="md-footer-social__link fa fa-globe"></a>
    
      <a href="https://github.com/MISP" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/MISPProject" class="md-footer-social__link fa fa-twitter"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.5e60981f.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
    
      
    
  </body>
</html>